<%@ page language="java" contentType="text/html; charset=ISO-8859-1"
    pageEncoding="ISO-8859-1"%>
    <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%>
	<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<!DOCTYPE html>
<html lang="en" >
<head>
    <meta charset="UTF-8">
    <title>Add New Invoice</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
          rel="stylesheet"
          integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
          crossorigin="anonymous">
    <SCRIPT language="javascript">
    function addRow(tableId) {
    	var table = document.getElementById(tableID);

		var rowCount = table.rows.length;
		var row = table.insertRow(rowCount);

		var cell1 = row.insertCell(0);
		cell1.innerHTML = rowCount + 1;
		
		var cell2 = row.insertCell(1);
		var element1 = document.createElement("input");
		element1.type = "text";
		element1.name="txtbox[]";
		cell1.appendChild(element1);

		
		

		var cell3 = row.insertCell(2);
		var element2 = document.createElement("textarea");
		cell3.appendChild(element2);
		
		var cell4 = row.insertCell(3);
		var element3 = document.createElement("input");
		element3.type = "number";
		element3.name="nmbr";
		cell4.appendChild(element3);
		
		var cell5 = row.insertCell(4);
		var element4 = document.createElement("input");
		element4.type = "number";
		element4.name="nmbr";
		cell4.appendChild(element3);
		
		var cell4 = row.insertCell(3);
		var element3 = document.createElement("input");
		element3.type = "number";
		element3.name="nmbr";
		cell4.appendChild(element3);
		
		var cell4 = row.insertCell(3);
		var element3 = document.createElement("input");
		element3.type = "number";
		element3.name="nmbr";
		cell4.appendChild(element3);
    }

    function deleteRow(e) {
        e.parentNode.parentNode.parentNode.removeChild(e.parentNode.parentNode);
        serialize();
    }

    function serialize() {
        const list = document.querySelectorAll(".serial");
        list.forEach((ele, idx) => {
            ele.innerHTML = idx + 1;
        })
    }
		

	</SCRIPT>
</head>
<body>
<div class="container">
    <h2>Add New Invoice</h2><br>
    
    <form:form  action="/saveInvoice" modelAttribute="invoiceInfo" method="POST">

        <form:hidden  path="id"
               placeholder="id" class="form-control mb-4 col-4"/>

        <form:input type="text" path="invoiceNo"
               placeholder="invoiceNo" class="form-control mb-4 col-4"/>

        <form:input type="text" path="billTo"
               placeholder="billTo" class="form-control mb-4 col-4"/>

        <form:input type="text" path="status"
               placeholder="status" class="form-control mb-4 col-4"/>

        <form:input type="date" path="invoiceDate"
               placeholder="invoiceDate" class="form-control mb-4 col-4"/>

        <form:input type="date" path="dueDate"
               placeholder="dueDate" class="form-control mb-4 col-4"/>
        <div>
            <table id="dataTable" border="1" class="table table-striped table-responsive-md">
                <thead>
                <tr>
                    <th>SNo</th>
                    <th>Product</th>
                    <th>Description</th>
                    <th>Price</th>
                    <th>Qty</th>
                    <th>Tax%</th>
                    <th>Total</th>
                    <th>
                        <button type="submit" name="addRow" onclick="addRow()">Add row</button>
                    </th>

                </tr>
                </thead>

                <tbody>

                    <%-- <tr  path="listOfProducts" var="product" varStatus="status">
                        
                        <td >
                        	<input name="listOfProducts[${status.index }].productId"
                        		   value="${listOfProducts.productId}"/>
                        </td>

                        <td>
                            <input type="text" 
                            	   name="listOfProducts[${status.index }].productName" 
                                   value="${listOfProducts.productName }"/>

                        </td>

                        <td>
                             <textarea  class="form-control rounded-0" 
                             			name="listOfProducts[${status.index}].description"
                             			value="${listOfProducts.description }" 
                             			id="description" rows="3"
                                       	maxlength="500"
                                       	placeholder="Description"
                                        ></textarea>
                        </td>

                        <td>
                            <input  type="number" 
                            		name="listOfProducts[${status.index}].price"
                            		value="${listOfProducts.price }"  
                            		id="price" 
                            		class="form-control" 
                            		placeholder="Price">
                        </td>

                        <td>
                            <input type="number" 
                            	   name="listOfProducts[${status.index}].qty"
                            	   value="${listOfProducts.qty }"   
                            	   class="form-control" 
                            	   id="qty" placeholder="Qty">
                        </td>

                        <td>
                            <input type="number" 
		                           name="listOfProducts[${status.index}].taxPercent"
		                           value="${listOfProducts.taxPercent }"   
		                           class="form-control" 
		                           id="taxPercent" placeholder="Tax(%)">
                        </td>

                        <td>
                            <input type="number"
                            	   name="listOfProducts[${status.index}].total"
                            	   value="${listOfProducts.total }"   
                            	   class="form-control" 
                            	   id="total" placeholder="Total">
                        </td>
                        <td>
                            <button type="submit" name="removeRow"  >Remove row</button>
                        </td>
                      

                    </tr> --%>
                          <tr>
                        
                        <td >1</td>

                        <td>
                            <input type="text" name="productName" >

                        </td>

                        <td>
                             <textarea class="form-control rounded-0" name="description" id="description" rows="3"
                                       maxlength="500"
                                       placeholder="Description"
                                        ></textarea>
                        </td>

                        <td>
                            <input type="number" name="price" id="price" class="form-control" placeholder="Price">
                        </td>

                        <td>
                            <input type="number" name="qty" class="form-control" id="qty" placeholder="Qty">
                        </td>

                        <td>
                            <input type="number" name="taxPercent" class="form-control" id="taxPercent" placeholder="Tax(%)">
                        </td>

                        <td>
                            <input type="number" name="total" class="form-control" id="total" placeholder="Total">
                        </td>
                        <td>
                            <button type="submit" name="removeRow"  >Remove row</button>
                        </td>
                       

                    </tr>

                </tbody>

            </table>
        </div>

        <button type="submit" class="btn btn-primary">save</button>
    </form:form>

</div>
<script type="text/javascript" src="script.js">
</script>
</body>
</html>